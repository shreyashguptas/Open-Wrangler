{
  "version": 3,
  "sources": ["../webview-src/previewApp.ts"],
  "sourcesContent": ["declare const bootstrap: { title: string; rows: unknown[][]; rowCount?: number; colCount?: number };\n\nconst root = document.getElementById('app')!;\nconst header = bootstrap.rows[0] || [];\nconst rawBody = bootstrap.rows.slice(1);\nlet body = rawBody.slice();\nlet dataRows = body.length;\nconst reportedRows = Number.isFinite(Number(bootstrap.rowCount)) ? Number(bootstrap.rowCount) : dataRows;\nconst totalCols = Number.isFinite(Number(bootstrap.colCount)) ? Number(bootstrap.colCount) : header.length;\nlet pageSize = 10;\nlet pageIndex = 0;\nlet sortCol: number = -1;\nlet sortDir: 'asc' | 'desc' | null = null;\n\nfunction el(tag: string, attrs: Record<string, string> = {}, ...children: Array<Node | string>) {\n  const n = document.createElement(tag);\n  Object.entries(attrs).forEach(([k, v]) => n.setAttribute(k, String(v)));\n  for (const c of children) n.append(c as any);\n  return n;\n}\n\nfunction renderHeader() {\n  return el('div', { class: 'header' },\n    el('span', { class: 'title' }, `Open \"${bootstrap.title}\" in Open\u2011Wrangler`),\n    el('span', { class: 'meta' }, `${reportedRows} rows \u00D7 ${totalCols} cols`)\n  );\n}\n\nfunction renderTable() {\n  const start = pageIndex * pageSize;\n  const end = Math.min(start + pageSize, dataRows);\n  const pageRows = body.slice(start, end);\n  const thead = el('thead');\n  const thr = el('tr');\n  header.forEach((h: any, i: number) => {\n    const isSorted = i === sortCol && !!sortDir;\n    const labelText = isSorted ? `${h} ${sortDir === 'asc' ? '\u25B2' : '\u25BC'}` : String(h);\n    const th = el('th', { 'data-col': String(i) });\n    const btn = el('button', { class: 'th-menu-button', title: 'Column options' }, '\u22EF');\n    btn.addEventListener('click', (ev) => { ev.preventDefault(); ev.stopPropagation(); openMenuFor(th as HTMLTableCellElement, i); });\n    th.addEventListener('contextmenu', (ev) => { ev.preventDefault(); openMenuFor(th as HTMLTableCellElement, i); });\n    const label = el('span', { class: 'th-label' }, labelText);\n    if (isSorted) (label as HTMLElement).classList.add('th-sorted');\n    th.append(el('div', { class: 'th-container' }, label, btn));\n    thr.append(th);\n  });\n  thead.append(thr);\n  const tbody = el('tbody');\n  pageRows.forEach(r => {\n    const tr = el('tr');\n    (r as unknown[]).forEach(v => tr.append(el('td', {}, v === undefined ? '' : String(v))));\n    tbody.append(tr);\n  });\n  const table = el('table', {}, thead, tbody);\n  return el('div', { class: 'grid' }, table);\n}\n\nfunction renderPager() {\n  const totalPages = Math.max(1, Math.ceil(dataRows / pageSize));\n  const info = el('span', {}, `Page ${pageIndex + 1} of ${totalPages}`);\n  const prev = el('button', { id: 'prev', disabled: pageIndex === 0 ? 'true' : '' }, '\u2039');\n  const next = el('button', { id: 'next', disabled: pageIndex + 1 >= totalPages ? 'true' : '' }, '\u203A');\n  const size = el('select', { id: 'size' },\n    el('option', { value: '10', selected: pageSize === 10 ? 'true' : '' }, '10'),\n    el('option', { value: '25', selected: pageSize === 25 ? 'true' : '' }, '25'),\n    el('option', { value: '50', selected: pageSize === 50 ? 'true' : '' }, '50')\n  );\n  const label = el('span', {}, 'per page');\n  const pager = el('div', { class: 'pager' }, prev, next, info, size, label);\n  (prev as HTMLButtonElement).onclick = () => { if (pageIndex > 0) { pageIndex--; update(); } };\n  (next as HTMLButtonElement).onclick = () => { const t = Math.ceil(dataRows / pageSize); if (pageIndex + 1 < t) { pageIndex++; update(); } };\n  (size as HTMLSelectElement).onchange = () => { pageSize = parseInt((size as HTMLSelectElement).value, 10); pageIndex = 0; update(); };\n  return pager;\n}\n\nfunction openMenuFor(thEl: HTMLElement, colIndex: number) {\n  const rect = thEl.getBoundingClientRect();\n  const x = rect.right - 8; const y = rect.bottom + 4;\n  showMenuAt(x, y, colIndex);\n}\n\nfunction showMenuAt(x: number, y: number, colIndex: number) {\n  hideMenu();\n  const menu = el('div', { class: 'ow-menu', id: 'ow-menu' });\n  const isSortedAsc = sortCol === colIndex && sortDir === 'asc';\n  const isSortedDesc = sortCol === colIndex && sortDir === 'desc';\n  const asc = el('div', { class: 'item' }, isSortedAsc ? '\u2713 Sort ascending' : 'Sort ascending');\n  const desc = el('div', { class: 'item' }, isSortedDesc ? '\u2713 Sort descending' : 'Sort descending');\n  const clear = el('div', { class: 'item' }, 'Clear sort');\n  (asc as HTMLElement).onclick = () => { sortBy(colIndex, 'asc'); };\n  (desc as HTMLElement).onclick = () => { sortBy(colIndex, 'desc'); };\n  (clear as HTMLElement).onclick = () => { clearSort(); };\n  (menu as HTMLElement).style.left = x + 'px';\n  (menu as HTMLElement).style.top = y + 'px';\n  menu.append(asc, desc, clear);\n  document.body.append(menu);\n  const dismiss = (ev: MouseEvent) => {\n    const m = document.getElementById('ow-menu');\n    if (!m) return;\n    if (!m.contains(ev.target as Node)) hideMenu();\n  };\n  setTimeout(() => {\n    document.addEventListener('click', dismiss);\n    document.addEventListener('contextmenu', dismiss);\n    document.addEventListener('scroll', hideMenu, { capture: true } as any);\n    window.addEventListener('resize', hideMenu);\n  }, 0);\n}\n\nfunction hideMenu() {\n  const existing = document.getElementById('ow-menu');\n  if (existing) existing.remove();\n  document.removeEventListener('scroll', hideMenu as any, { capture: true } as any);\n  window.removeEventListener('resize', hideMenu);\n}\n\nfunction sortBy(colIndex: number, direction: 'asc' | 'desc') {\n  sortCol = colIndex; sortDir = direction;\n  const numeric = isColumnNumeric(colIndex); const factor = direction === 'asc' ? 1 : -1;\n  body = rawBody.slice().sort((a, b) => compareValues((a as any)[colIndex], (b as any)[colIndex], numeric) * factor);\n  dataRows = body.length; pageIndex = 0; hideMenu(); update();\n}\n\nfunction clearSort() {\n  sortCol = -1; sortDir = null; body = rawBody.slice(); dataRows = body.length; pageIndex = 0; hideMenu(); update();\n}\n\nfunction isColumnNumeric(colIndex: number) {\n  const sample = rawBody.slice(0, Math.min(100, rawBody.length)).map(r => (r as any)[colIndex]);\n  return sample.every(v => v === null || v === '' || v === undefined || !Number.isNaN(Number(v)));\n}\n\nfunction compareValues(a: any, b: any, numeric: boolean) {\n  const aMissing = a === undefined || a === null || a === '';\n  const bMissing = b === undefined || b === null || b === '';\n  if (aMissing && bMissing) return 0; if (aMissing) return 1; if (bMissing) return -1;\n  if (numeric) { const na = Number(a); const nb = Number(b); if (!Number.isFinite(na) && !Number.isFinite(nb)) return 0; if (!Number.isFinite(na)) return 1; if (!Number.isFinite(nb)) return -1; return na - nb; }\n  return String(a).localeCompare(String(b), undefined, { numeric: true, sensitivity: 'base' });\n}\n\nfunction update() { root.replaceChildren(renderHeader(), renderTable(), renderPager()); }\nupdate();\n\n\n"],
  "mappings": ";;;AAEA,MAAM,OAAO,SAAS,eAAe,KAAK;AAC1C,MAAM,SAAS,UAAU,KAAK,CAAC,KAAK,CAAC;AACrC,MAAM,UAAU,UAAU,KAAK,MAAM,CAAC;AACtC,MAAI,OAAO,QAAQ,MAAM;AACzB,MAAI,WAAW,KAAK;AACpB,MAAM,eAAe,OAAO,SAAS,OAAO,UAAU,QAAQ,CAAC,IAAI,OAAO,UAAU,QAAQ,IAAI;AAChG,MAAM,YAAY,OAAO,SAAS,OAAO,UAAU,QAAQ,CAAC,IAAI,OAAO,UAAU,QAAQ,IAAI,OAAO;AACpG,MAAI,WAAW;AACf,MAAI,YAAY;AAChB,MAAI,UAAkB;AACtB,MAAI,UAAiC;AAErC,WAAS,GAAG,KAAa,QAAgC,CAAC,MAAM,UAAgC;AAC9F,UAAM,IAAI,SAAS,cAAc,GAAG;AACpC,WAAO,QAAQ,KAAK,EAAE,QAAQ,CAAC,CAAC,GAAG,CAAC,MAAM,EAAE,aAAa,GAAG,OAAO,CAAC,CAAC,CAAC;AACtE,eAAW,KAAK,SAAU,GAAE,OAAO,CAAQ;AAC3C,WAAO;AAAA,EACT;AAEA,WAAS,eAAe;AACtB,WAAO;AAAA,MAAG;AAAA,MAAO,EAAE,OAAO,SAAS;AAAA,MACjC,GAAG,QAAQ,EAAE,OAAO,QAAQ,GAAG,SAAS,UAAU,KAAK,yBAAoB;AAAA,MAC3E,GAAG,QAAQ,EAAE,OAAO,OAAO,GAAG,GAAG,YAAY,cAAW,SAAS,OAAO;AAAA,IAC1E;AAAA,EACF;AAEA,WAAS,cAAc;AACrB,UAAM,QAAQ,YAAY;AAC1B,UAAM,MAAM,KAAK,IAAI,QAAQ,UAAU,QAAQ;AAC/C,UAAM,WAAW,KAAK,MAAM,OAAO,GAAG;AACtC,UAAM,QAAQ,GAAG,OAAO;AACxB,UAAM,MAAM,GAAG,IAAI;AACnB,WAAO,QAAQ,CAAC,GAAQ,MAAc;AACpC,YAAM,WAAW,MAAM,WAAW,CAAC,CAAC;AACpC,YAAM,YAAY,WAAW,GAAG,CAAC,IAAI,YAAY,QAAQ,WAAM,QAAG,KAAK,OAAO,CAAC;AAC/E,YAAM,KAAK,GAAG,MAAM,EAAE,YAAY,OAAO,CAAC,EAAE,CAAC;AAC7C,YAAM,MAAM,GAAG,UAAU,EAAE,OAAO,kBAAkB,OAAO,iBAAiB,GAAG,QAAG;AAClF,UAAI,iBAAiB,SAAS,CAAC,OAAO;AAAE,WAAG,eAAe;AAAG,WAAG,gBAAgB;AAAG,oBAAY,IAA4B,CAAC;AAAA,MAAG,CAAC;AAChI,SAAG,iBAAiB,eAAe,CAAC,OAAO;AAAE,WAAG,eAAe;AAAG,oBAAY,IAA4B,CAAC;AAAA,MAAG,CAAC;AAC/G,YAAM,QAAQ,GAAG,QAAQ,EAAE,OAAO,WAAW,GAAG,SAAS;AACzD,UAAI,SAAU,CAAC,MAAsB,UAAU,IAAI,WAAW;AAC9D,SAAG,OAAO,GAAG,OAAO,EAAE,OAAO,eAAe,GAAG,OAAO,GAAG,CAAC;AAC1D,UAAI,OAAO,EAAE;AAAA,IACf,CAAC;AACD,UAAM,OAAO,GAAG;AAChB,UAAM,QAAQ,GAAG,OAAO;AACxB,aAAS,QAAQ,OAAK;AACpB,YAAM,KAAK,GAAG,IAAI;AAClB,MAAC,EAAgB,QAAQ,OAAK,GAAG,OAAO,GAAG,MAAM,CAAC,GAAG,MAAM,SAAY,KAAK,OAAO,CAAC,CAAC,CAAC,CAAC;AACvF,YAAM,OAAO,EAAE;AAAA,IACjB,CAAC;AACD,UAAM,QAAQ,GAAG,SAAS,CAAC,GAAG,OAAO,KAAK;AAC1C,WAAO,GAAG,OAAO,EAAE,OAAO,OAAO,GAAG,KAAK;AAAA,EAC3C;AAEA,WAAS,cAAc;AACrB,UAAM,aAAa,KAAK,IAAI,GAAG,KAAK,KAAK,WAAW,QAAQ,CAAC;AAC7D,UAAM,OAAO,GAAG,QAAQ,CAAC,GAAG,QAAQ,YAAY,CAAC,OAAO,UAAU,EAAE;AACpE,UAAM,OAAO,GAAG,UAAU,EAAE,IAAI,QAAQ,UAAU,cAAc,IAAI,SAAS,GAAG,GAAG,QAAG;AACtF,UAAM,OAAO,GAAG,UAAU,EAAE,IAAI,QAAQ,UAAU,YAAY,KAAK,aAAa,SAAS,GAAG,GAAG,QAAG;AAClG,UAAM,OAAO;AAAA,MAAG;AAAA,MAAU,EAAE,IAAI,OAAO;AAAA,MACrC,GAAG,UAAU,EAAE,OAAO,MAAM,UAAU,aAAa,KAAK,SAAS,GAAG,GAAG,IAAI;AAAA,MAC3E,GAAG,UAAU,EAAE,OAAO,MAAM,UAAU,aAAa,KAAK,SAAS,GAAG,GAAG,IAAI;AAAA,MAC3E,GAAG,UAAU,EAAE,OAAO,MAAM,UAAU,aAAa,KAAK,SAAS,GAAG,GAAG,IAAI;AAAA,IAC7E;AACA,UAAM,QAAQ,GAAG,QAAQ,CAAC,GAAG,UAAU;AACvC,UAAM,QAAQ,GAAG,OAAO,EAAE,OAAO,QAAQ,GAAG,MAAM,MAAM,MAAM,MAAM,KAAK;AACzE,IAAC,KAA2B,UAAU,MAAM;AAAE,UAAI,YAAY,GAAG;AAAE;AAAa,eAAO;AAAA,MAAG;AAAA,IAAE;AAC5F,IAAC,KAA2B,UAAU,MAAM;AAAE,YAAM,IAAI,KAAK,KAAK,WAAW,QAAQ;AAAG,UAAI,YAAY,IAAI,GAAG;AAAE;AAAa,eAAO;AAAA,MAAG;AAAA,IAAE;AAC1I,IAAC,KAA2B,WAAW,MAAM;AAAE,iBAAW,SAAU,KAA2B,OAAO,EAAE;AAAG,kBAAY;AAAG,aAAO;AAAA,IAAG;AACpI,WAAO;AAAA,EACT;AAEA,WAAS,YAAY,MAAmB,UAAkB;AACxD,UAAM,OAAO,KAAK,sBAAsB;AACxC,UAAM,IAAI,KAAK,QAAQ;AAAG,UAAM,IAAI,KAAK,SAAS;AAClD,eAAW,GAAG,GAAG,QAAQ;AAAA,EAC3B;AAEA,WAAS,WAAW,GAAW,GAAW,UAAkB;AAC1D,aAAS;AACT,UAAM,OAAO,GAAG,OAAO,EAAE,OAAO,WAAW,IAAI,UAAU,CAAC;AAC1D,UAAM,cAAc,YAAY,YAAY,YAAY;AACxD,UAAM,eAAe,YAAY,YAAY,YAAY;AACzD,UAAM,MAAM,GAAG,OAAO,EAAE,OAAO,OAAO,GAAG,cAAc,0BAAqB,gBAAgB;AAC5F,UAAM,OAAO,GAAG,OAAO,EAAE,OAAO,OAAO,GAAG,eAAe,2BAAsB,iBAAiB;AAChG,UAAM,QAAQ,GAAG,OAAO,EAAE,OAAO,OAAO,GAAG,YAAY;AACvD,IAAC,IAAoB,UAAU,MAAM;AAAE,aAAO,UAAU,KAAK;AAAA,IAAG;AAChE,IAAC,KAAqB,UAAU,MAAM;AAAE,aAAO,UAAU,MAAM;AAAA,IAAG;AAClE,IAAC,MAAsB,UAAU,MAAM;AAAE,gBAAU;AAAA,IAAG;AACtD,IAAC,KAAqB,MAAM,OAAO,IAAI;AACvC,IAAC,KAAqB,MAAM,MAAM,IAAI;AACtC,SAAK,OAAO,KAAK,MAAM,KAAK;AAC5B,aAAS,KAAK,OAAO,IAAI;AACzB,UAAM,UAAU,CAAC,OAAmB;AAClC,YAAM,IAAI,SAAS,eAAe,SAAS;AAC3C,UAAI,CAAC,EAAG;AACR,UAAI,CAAC,EAAE,SAAS,GAAG,MAAc,EAAG,UAAS;AAAA,IAC/C;AACA,eAAW,MAAM;AACf,eAAS,iBAAiB,SAAS,OAAO;AAC1C,eAAS,iBAAiB,eAAe,OAAO;AAChD,eAAS,iBAAiB,UAAU,UAAU,EAAE,SAAS,KAAK,CAAQ;AACtE,aAAO,iBAAiB,UAAU,QAAQ;AAAA,IAC5C,GAAG,CAAC;AAAA,EACN;AAEA,WAAS,WAAW;AAClB,UAAM,WAAW,SAAS,eAAe,SAAS;AAClD,QAAI,SAAU,UAAS,OAAO;AAC9B,aAAS,oBAAoB,UAAU,UAAiB,EAAE,SAAS,KAAK,CAAQ;AAChF,WAAO,oBAAoB,UAAU,QAAQ;AAAA,EAC/C;AAEA,WAAS,OAAO,UAAkB,WAA2B;AAC3D,cAAU;AAAU,cAAU;AAC9B,UAAM,UAAU,gBAAgB,QAAQ;AAAG,UAAM,SAAS,cAAc,QAAQ,IAAI;AACpF,WAAO,QAAQ,MAAM,EAAE,KAAK,CAAC,GAAG,MAAM,cAAe,EAAU,QAAQ,GAAI,EAAU,QAAQ,GAAG,OAAO,IAAI,MAAM;AACjH,eAAW,KAAK;AAAQ,gBAAY;AAAG,aAAS;AAAG,WAAO;AAAA,EAC5D;AAEA,WAAS,YAAY;AACnB,cAAU;AAAI,cAAU;AAAM,WAAO,QAAQ,MAAM;AAAG,eAAW,KAAK;AAAQ,gBAAY;AAAG,aAAS;AAAG,WAAO;AAAA,EAClH;AAEA,WAAS,gBAAgB,UAAkB;AACzC,UAAM,SAAS,QAAQ,MAAM,GAAG,KAAK,IAAI,KAAK,QAAQ,MAAM,CAAC,EAAE,IAAI,OAAM,EAAU,QAAQ,CAAC;AAC5F,WAAO,OAAO,MAAM,OAAK,MAAM,QAAQ,MAAM,MAAM,MAAM,UAAa,CAAC,OAAO,MAAM,OAAO,CAAC,CAAC,CAAC;AAAA,EAChG;AAEA,WAAS,cAAc,GAAQ,GAAQ,SAAkB;AACvD,UAAM,WAAW,MAAM,UAAa,MAAM,QAAQ,MAAM;AACxD,UAAM,WAAW,MAAM,UAAa,MAAM,QAAQ,MAAM;AACxD,QAAI,YAAY,SAAU,QAAO;AAAG,QAAI,SAAU,QAAO;AAAG,QAAI,SAAU,QAAO;AACjF,QAAI,SAAS;AAAE,YAAM,KAAK,OAAO,CAAC;AAAG,YAAM,KAAK,OAAO,CAAC;AAAG,UAAI,CAAC,OAAO,SAAS,EAAE,KAAK,CAAC,OAAO,SAAS,EAAE,EAAG,QAAO;AAAG,UAAI,CAAC,OAAO,SAAS,EAAE,EAAG,QAAO;AAAG,UAAI,CAAC,OAAO,SAAS,EAAE,EAAG,QAAO;AAAI,aAAO,KAAK;AAAA,IAAI;AAChN,WAAO,OAAO,CAAC,EAAE,cAAc,OAAO,CAAC,GAAG,QAAW,EAAE,SAAS,MAAM,aAAa,OAAO,CAAC;AAAA,EAC7F;AAEA,WAAS,SAAS;AAAE,SAAK,gBAAgB,aAAa,GAAG,YAAY,GAAG,YAAY,CAAC;AAAA,EAAG;AACxF,SAAO;",
  "names": []
}
